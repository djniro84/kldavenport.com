<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">

  <meta name="generator" content="Hugo 0.54.0" />
  <link rel="canonical" href="https://kldavenport.com/the-35-hour-work-week/">

  

  <link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
  <link rel="manifest" href="/site.webmanifest">
  <link rel="mask-icon" href="/safari-pinned-tab.svg" color="#000000">
  <meta name="msapplication-TileColor" content="#ffffff">
  <meta name="theme-color" content="#ffffff">

  <link rel="stylesheet" href="https://kldavenport.com/css/prism.css" media="none" onload="this.media='all';">

  
  
  <link rel="stylesheet" type="text/css" href="https://kldavenport.com/css/styles.css">

  <style id="inverter" media="none">
    html { filter: invert(100%) }
    * { background-color: inherit }
    img:not([src*=".svg"]), .colors, iframe, .demo-container { filter: invert(100%) }
  </style>

  
  
  <title>The 35 Hour Work Week with Python | Kevin Davenport Engineering &amp; ML blog</title>
</head>

  <body>
    <a href="#main">skip to content</a>
    <svg style="display: none">
  <symbol id="bookmark" viewBox="0 0 40 50">
   <g transform="translate(2266 3206.2)">
    <path style="stroke:currentColor;stroke-width:3.2637;fill:none" d="m-2262.2-3203.4-.2331 42.195 16.319-16.318 16.318 16.318.2331-42.428z"/>
   </g>
  </symbol>

  <symbol id="w3c" viewBox="0 0 127.09899 67.763">
   <text font-size="83" style="font-size:83px;font-family:Trebuchet;letter-spacing:-12;fill-opacity:0" letter-spacing="-12" y="67.609352" x="-26.782778">W3C</text>
   <text font-size="83" style="font-size:83px;font-weight:bold;font-family:Trebuchet;fill-opacity:0" y="67.609352" x="153.21722" font-weight="bold">SVG</text>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m33.695.377 12.062 41.016 12.067-41.016h8.731l-19.968 67.386h-.831l-12.48-41.759-12.479 41.759h-.832l-19.965-67.386h8.736l12.061 41.016 8.154-27.618-3.993-13.397h8.737z"/>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m91.355 46.132c0 6.104-1.624 11.234-4.862 15.394-3.248 4.158-7.45 6.237-12.607 6.237-3.882 0-7.263-1.238-10.148-3.702-2.885-2.47-5.02-5.812-6.406-10.022l6.82-2.829c1.001 2.552 2.317 4.562 3.953 6.028 1.636 1.469 3.56 2.207 5.781 2.207 2.329 0 4.3-1.306 5.909-3.911 1.609-2.606 2.411-5.738 2.411-9.401 0-4.049-.861-7.179-2.582-9.399-1.995-2.604-5.129-3.912-9.397-3.912h-3.327v-3.991l11.646-20.133h-14.062l-3.911 6.655h-2.493v-14.976h32.441v4.075l-12.31 21.217c4.324 1.385 7.596 3.911 9.815 7.571 2.22 3.659 3.329 7.953 3.329 12.892z"/>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m125.21 0 1.414 8.6-5.008 9.583s-1.924-4.064-5.117-6.314c-2.693-1.899-4.447-2.309-7.186-1.746-3.527.73-7.516 4.938-9.258 10.13-2.084 6.21-2.104 9.218-2.178 11.978-.115 4.428.58 7.043.58 7.043s-3.04-5.626-3.011-13.866c.018-5.882.947-11.218 3.666-16.479 2.404-4.627 5.954-7.404 9.114-7.728 3.264-.343 5.848 1.229 7.841 2.938 2.089 1.788 4.213 5.698 4.213 5.698l4.94-9.837z"/>
   <path style="fill:currentColor;image-rendering:optimizeQuality;shape-rendering:geometricPrecision" d="m125.82 48.674s-2.208 3.957-3.589 5.48c-1.379 1.524-3.849 4.209-6.896 5.555-3.049 1.343-4.646 1.598-7.661 1.306-3.01-.29-5.807-2.032-6.786-2.764-.979-.722-3.486-2.864-4.897-4.854-1.42-2-3.634-5.995-3.634-5.995s1.233 4.001 2.007 5.699c.442.977 1.81 3.965 3.749 6.572 1.805 2.425 5.315 6.604 10.652 7.545 5.336.945 9.002-1.449 9.907-2.031.907-.578 2.819-2.178 4.032-3.475 1.264-1.351 2.459-3.079 3.116-4.108.487-.758 1.276-2.286 1.276-2.286l-1.276-6.644z"/>
  </symbol>

  <symbol id="tag" viewBox="0 0 177.16535 177.16535">
    <g transform="translate(0 -875.2)">
     <path style="fill-rule:evenodd;stroke-width:0;fill:currentColor" d="m159.9 894.3-68.79 8.5872-75.42 77.336 61.931 60.397 75.429-76.565 6.8495-69.755zm-31.412 31.835a10.813 10.813 0 0 1 1.8443 2.247 10.813 10.813 0 0 1 -3.5174 14.872l-.0445.0275a10.813 10.813 0 0 1 -14.86 -3.5714 10.813 10.813 0 0 1 3.5563 -14.863 10.813 10.813 0 0 1 13.022 1.2884z"/>
    </g>
  </symbol>

  <symbol id="balloon" viewBox="0 0 141.73228 177.16535">
   <g transform="translate(0 -875.2)">
    <g>
     <path style="fill:currentColor" d="m68.156 882.83-.88753 1.4269c-4.9564 7.9666-6.3764 17.321-5.6731 37.378.36584 10.437 1.1246 23.51 1.6874 29.062.38895 3.8372 3.8278 32.454 4.6105 38.459 4.6694-.24176 9.2946.2879 14.377 1.481 1.2359-3.2937 5.2496-13.088 8.886-21.623 6.249-14.668 8.4128-21.264 10.253-31.252 1.2464-6.7626 1.6341-12.156 1.4204-19.764-.36325-12.93-2.1234-19.487-6.9377-25.843-2.0833-2.7507-6.9865-7.6112-7.9127-7.8436-.79716-.20019-6.6946-1.0922-6.7755-1.0248-.02213.0182-5.0006-.41858-7.5248-.22808l-2.149-.22808h-3.3738z"/>
     <path style="fill:currentColor" d="m61.915 883.28-3.2484.4497c-1.7863.24724-3.5182.53481-3.8494.63994-2.4751.33811-4.7267.86957-6.7777 1.5696-.28598 0-1.0254.20146-2.3695.58589-5.0418 1.4418-6.6374 2.2604-8.2567 4.2364-6.281 7.6657-11.457 18.43-12.932 26.891-1.4667 8.4111.71353 22.583 5.0764 32.996 3.8064 9.0852 13.569 25.149 22.801 37.517 1.3741 1.841 2.1708 2.9286 2.4712 3.5792 3.5437-1.1699 6.8496-1.9336 10.082-2.3263-1.3569-5.7831-4.6968-21.86-6.8361-33.002-.92884-4.8368-2.4692-14.322-3.2452-19.991-.68557-5.0083-.77707-6.9534-.74159-15.791.04316-10.803.41822-16.162 1.5026-21.503 1.4593-5.9026 3.3494-11.077 6.3247-15.852z"/>
     <path style="fill:currentColor" d="m94.499 885.78c-.10214-.0109-.13691 0-.0907.0409.16033.13489 1.329 1.0675 2.5976 2.0723 6.7003 5.307 11.273 14.568 12.658 25.638.52519 4.1949.24765 14.361-.5059 18.523-2.4775 13.684-9.7807 32.345-20.944 53.519l-3.0559 5.7971c2.8082.76579 5.7915 1.727 8.9926 2.8441 11.562-11.691 18.349-19.678 24.129-28.394 7.8992-11.913 11.132-20.234 12.24-31.518.98442-10.02-1.5579-20.876-6.7799-28.959-.2758-.4269-.57803-.86856-.89617-1.3166-3.247-6.13-9.752-12.053-21.264-16.131-2.3687-.86369-6.3657-2.0433-7.0802-2.1166z"/>
     <path style="fill:currentColor" d="m32.52 892.22c-.20090-.13016-1.4606.81389-3.9132 2.7457-11.486 9.0476-17.632 24.186-16.078 39.61.79699 7.9138 2.4066 13.505 5.9184 20.562 5.8577 11.77 14.749 23.219 30.087 38.74.05838.059.12188.1244.18052.1838 1.3166-.5556 2.5965-1.0618 3.8429-1.5199-.66408-.32448-1.4608-1.3297-3.8116-4.4602-5.0951-6.785-8.7512-11.962-13.051-18.486-5.1379-7.7948-5.0097-7.5894-8.0586-13.054-6.2097-11.13-8.2674-17.725-8.6014-27.563-.21552-6.3494.13041-9.2733 1.775-14.987 2.1832-7.5849 3.9273-10.986 9.2693-18.07 1.7839-2.3656 2.6418-3.57 2.4409-3.7003z"/>
     <path style="fill:currentColor" d="m69.133 992.37c-6.2405.0309-12.635.76718-19.554 2.5706 4.6956 4.7759 9.935 10.258 12.05 12.625l4.1272 4.6202h11.493l3.964-4.4516c2.0962-2.3541 7.4804-7.9845 12.201-12.768-8.378-1.4975-16.207-2.6353-24.281-2.5955z"/>
     <rect style="stroke-width:0;fill:currentColor" ry="2.0328" height="27.746" width="22.766" y="1017.7" x="60.201"/>
    </g>
   </g>
  </symbol>

  <symbol id="info" viewBox="0 0 41.667 41.667">
   <g transform="translate(-37.035 -1004.6)">
    <path style="stroke-linejoin:round;stroke:currentColor;stroke-linecap:round;stroke-width:3.728;fill:none" d="m76.25 1030.2a18.968 18.968 0 0 1 -23.037 13.709 18.968 18.968 0 0 1 -13.738 -23.019 18.968 18.968 0 0 1 23.001 -13.768 18.968 18.968 0 0 1 13.798 22.984"/>
    <g transform="matrix(1.1146 0 0 1.1146 -26.276 -124.92)">
     <path style="stroke:currentColor;stroke-linecap:round;stroke-width:3.728;fill:none" d="m75.491 1039.5v-8.7472"/>
     <path style="stroke-width:0;fill:currentColor" transform="scale(-1)" d="m-73.193-1024.5a2.3719 2.3719 0 0 1 -2.8807 1.7142 2.3719 2.3719 0 0 1 -1.718 -2.8785 2.3719 2.3719 0 0 1 2.8763 -1.7217 2.3719 2.3719 0 0 1 1.7254 2.8741"/>
    </g>
   </g>
  </symbol>

  <symbol id="warning" viewBox="0 0 48.430474 41.646302">
    <g transform="translate(-1.1273 -1010.2)">
     <path style="stroke-linejoin:round;stroke:currentColor;stroke-linecap:round;stroke-width:4.151;fill:none" d="m25.343 1012.3-22.14 37.496h44.28z"/>
     <path style="stroke:currentColor;stroke-linecap:round;stroke-width:4.1512;fill:none" d="m25.54 1027.7v8.7472"/>
     <path style="stroke-width:0;fill:currentColor" d="m27.839 1042.8a2.3719 2.3719 0 0 1 -2.8807 1.7143 2.3719 2.3719 0 0 1 -1.718 -2.8785 2.3719 2.3719 0 0 1 2.8763 -1.7217 2.3719 2.3719 0 0 1 1.7254 2.8741"/>
    </g>
  </symbol>

  <symbol id="menu" viewBox="0 0 50 50">
     <rect style="stroke-width:0;fill:currentColor" height="10" width="50" y="0" x="0"/>
     <rect style="stroke-width:0;fill:currentColor" height="10" width="50" y="20" x="0"/>
     <rect style="stroke-width:0;fill:currentColor" height="10" width="50" y="40" x="0"/>
   </symbol>

   <symbol id="link" viewBox="0 0 50 50">
    <g transform="translate(0 -1002.4)">
     <g transform="matrix(.095670 0 0 .095670 2.3233 1004.9)">
      <g>
       <path style="stroke-width:0;fill:currentColor" d="m452.84 192.9-128.65 128.65c-35.535 35.54-93.108 35.54-128.65 0l-42.881-42.886 42.881-42.876 42.884 42.876c11.845 11.822 31.064 11.846 42.886 0l128.64-128.64c11.816-11.831 11.816-31.066 0-42.9l-42.881-42.881c-11.822-11.814-31.064-11.814-42.887 0l-45.928 45.936c-21.292-12.531-45.491-17.905-69.449-16.291l72.501-72.526c35.535-35.521 93.136-35.521 128.64 0l42.886 42.881c35.535 35.523 35.535 93.141-.001 128.66zm-254.28 168.51-45.903 45.9c-11.845 11.846-31.064 11.817-42.881 0l-42.884-42.881c-11.845-11.821-11.845-31.041 0-42.886l128.65-128.65c11.819-11.814 31.069-11.814 42.884 0l42.886 42.886 42.876-42.886-42.876-42.881c-35.54-35.521-93.113-35.521-128.65 0l-128.65 128.64c-35.538 35.545-35.538 93.146 0 128.65l42.883 42.882c35.51 35.54 93.11 35.54 128.65 0l72.496-72.499c-23.956 1.597-48.092-3.784-69.474-16.283z"/>
      </g>
     </g>
    </g>
  </symbol>

  <symbol id="doc" viewBox="0 0 35 45">
   <g transform="translate(-147.53 -539.83)">
    <path style="stroke:currentColor;stroke-width:2.4501;fill:none" d="m149.38 542.67v39.194h31.354v-39.194z"/>
    <g style="stroke-width:25" transform="matrix(.098003 0 0 .098003 133.69 525.96)">
     <path d="m220 252.36h200" style="stroke:currentColor;stroke-width:25;fill:none"/>
     <path style="stroke:currentColor;stroke-width:25;fill:none" d="m220 409.95h200"/>
     <path d="m220 488.74h200" style="stroke:currentColor;stroke-width:25;fill:none"/>
     <path d="m220 331.15h200" style="stroke:currentColor;stroke-width:25;fill:none"/>
    </g>
   </g>
 </symbol>

 <symbol id="tick" viewBox="0 0 177.16535 177.16535">
  <g transform="translate(0 -875.2)">
   <rect style="stroke-width:0;fill:currentColor" transform="rotate(30)" height="155" width="40" y="702.99" x="556.82"/>
   <rect style="stroke-width:0;fill:currentColor" transform="rotate(30)" height="40" width="90.404" y="817.99" x="506.42"/>
  </g>
 </symbol>
</svg>

    <div class="wrapper">
      <header class="intro-and-nav" role="banner">
  <div>
    <div class="intro">
      <a class="logo" href="/" aria-label="Kevin Davenport Engineering &amp; ML blog home page">
        <img src="https://kldavenport.com/images/logo.svg" alt="">
      </a>
      <p class="library-desc">
        
      </p>
    </div>
    <nav id="patterns-nav" class="patterns" role="navigation">
  <h2 class="vh">Main navigation</h2>
  <button id="menu-button" aria-expanded="false">
    <svg viewBox="0 0 50 50" aria-hidden="true" focusable="false">
      <use xlink:href="#menu"></use>
    </svg>
    Menu
  </button>
  
  <ul id="patterns-list">
  
    <li class="pattern">
      
      
      
      
      <a href="/post/" aria-current="page">
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">Blog</span>
      </a>
    </li>
  
    <li class="pattern">
      
      
      
      
      <a href="/about/" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">About</span>
      </a>
    </li>
  
    <li class="pattern">
      
      
      
      
      <a href="/bike-travel/" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">Bike Travel</span>
      </a>
    </li>
  
    <li class="pattern">
      
      
      
      
      <a href="/tags/" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">Tags</span>
      </a>
    </li>
  
    <li class="pattern">
      
      
      
      
      <a href="/index.xml" >
        <svg class="bookmark-icon" aria-hidden="true" focusable="false" viewBox="0 0 40 50">
          <use xlink:href="#bookmark"></use>
        </svg>
        <span class="text">RSS</span>
      </a>
    </li>
  
  </ul>
</nav>
  </div>
</header>
      <div class="main-and-footer">
        <div>
          
  <main id="main">
    <h1>
      <svg class="bookmark-icon" aria-hidden="true" viewBox="0 0 40 50" focusable="false">
        <use xlink:href="#bookmark"></use>
      </svg>
      The 35 Hour Work Week with Python
    </h1>
    <div class="date">
      
      <strong aria-hidden="true">Publish date: </strong>Jan 17, 2015
    </div>
    
      <div class="tags">
        <strong aria-hidden="true">Tags: </strong>
        <ul aria-label="tags">
          
            <li>
              <svg class="tag-icon" aria-hidden="true" viewBox="0 0 177.16535 177.16535" focusable="false">
                <use xlink:href="#tag"></use>
              </svg>
              <a href="https://kldavenport.com/tags/time-series">time series</a>
            </li>
          
            <li>
              <svg class="tag-icon" aria-hidden="true" viewBox="0 0 177.16535 177.16535" focusable="false">
                <use xlink:href="#tag"></use>
              </svg>
              <a href="https://kldavenport.com/tags/economics">economics</a>
            </li>
          
            <li>
              <svg class="tag-icon" aria-hidden="true" viewBox="0 0 177.16535 177.16535" focusable="false">
                <use xlink:href="#tag"></use>
              </svg>
              <a href="https://kldavenport.com/tags/statistics">statistics</a>
            </li>
          
        </ul>
      </div>
    
    
    
      

  <nav class="toc" aria-labelledby="toc-heading">
    <h2 id="toc-heading">Table of contents</h2>
    <ol>
      
        <li>
          <a href="#loading-and-transforming-the-data">
            Loading and Transforming the Data
          </a>
        </li>
      
        <li>
          <a href="#examining-relationships-with-plotting">
            Examining Relationships with Plotting
          </a>
        </li>
      
        <li>
          <a href="#statistical-methods">
            Statistical Methods
          </a>
        </li>
      
        <li>
          <a href="#imputation-filling-missing-data">
            Imputation (filling missing data)
          </a>
        </li>
      
        <li>
          <a href="#trend-extrapolation">
            Trend Extrapolation
          </a>
        </li>
      
    </ol>
  </nav>


    
    

<p>I was prompted to write this post after reading the NYT’s <a href="https://www.nytimes.com/2014/11/27/business/international/france-has-second-thoughts-on-its-35-hour-workweek.html">In France, New Review of 35-Hour Workweek</a>. For those not familiar with the 35-hour workweek, France adopted it in February 2000 with the suppport of then Prime Minister Lionel Jospin and the Minister of Labour Martine Aubry. Simply stated, the goal was to increase quality of life by reducing the work hour per worker ratio by requiring corporations to hire more workers to maintain the same work output as before. This in theory would also reduce the historic 10% unemployment rate.</p>

<p>I mostly write about ML, but I’ve been meaning to write about Pandas’ latest features and tight integration with SciPy such as data imputation and statistical modeling, and the actual working hours of EU countries will serve as fun source of data for my examples. I found data on the annual average hours worked per EU country from 1998 to 2013 on <a href="http://www.rexecode.fr/public/Analyses-et-previsions/Documents-de-travail/La-duree-effective-annuelle-du-travail-en-France-et-en-Europe-en-2013">The Economic Observation and Research Center for the Development of the Economy and Enterprise Development</a> website that have the best hosting from these Web Hosting Reviews – <a href="https://www.armchairempire.com/Reviews/web-hosting">Best Web Hosts 2017</a>. This notebook won’t serve as in-depth research on the efficacy of this policy, but more of a tutorial on data exploration, although a follow-up post exploring the interactions of commonly tracked economic factors and externalities of the policy might be fun.</p>

<p>In this IPython notebook we’ll work through generating descriptive statistics on our hours worked dataset then work through the process of interpolation to and extrapolation as defined below:</p>

<p>Interpolation is an estimation of a value within two known values in a sequence of values. For this data this might mean replacing missing average hour values in given date positions between the min and max observations.</p>

<p>Extrapolation is an estimation of a value based on extending a known sequence of values or facts beyond the area that is certainly known. Extrapolation is subject to greater uncertainty and a higher risk of producing meaningless data. For this data where the max observed date is 2013, we might want to extrapolate what the data points might be out to 2015.</p>

<pre><code class="language-python">import pandas as pd
import numpy as np
import scipy as sp
import statsmodels.api as sm
import statsmodels.graphics.tsaplots as tsaplots
from scipy import stats
import seaborn as sns
from pylab import rcParams
</code></pre>

<h2 id="loading-and-transforming-the-data">Loading and Transforming the Data</h2>

<p>Let&rsquo;s inspect the composition of our source data.</p>

<pre><code class="language-python">%%timeit
x = np.array([2,2,2])
</code></pre>

<p><code>The slowest run took 31.16 times longer than the fastest. This could mean that an intermediate result is being cached.
1000000 loops, best of 3: 1.22 µs per loop</code></p>

<pre><code class="language-bash">%%bash 
head -n 3 data/historic_euro_hrs_worked.csv
</code></pre>

<p><code>,1998,1999,2000,2001,2002,2003,2004,2005,2006,2007,2008,2009,2010,2011,2012,2013
Belgium,1896,1737,1733,1757,1763,1769,1751,1709,1725,1738,1752,1719,1765,1768,1767,1765
Bulgaria,N.a.,N.a.,N.a.,2005,2006,1964,2007,1997,2000,1989,1978,1913,1976,1972,1955,1954</code></p>

<p>The original document specifies missing or NA values as &lsquo;N.a.&rsquo;. Rather than replacing these values with <code>df.replace()</code> after loading the dataframe, <code>read_csv</code> provides a parameter for replacing specific strings with true NaN values on load.</p>

<pre><code class="language-python">df = pd.read_csv('data/historic_euro_hrs_worked.csv',  na_values='N.a.', index_col= 0)
df.info()
</code></pre>

<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 28 entries, Belgium to UK
Data columns (total 16 columns):
1998    24 non-null float64
1999    24 non-null float64
2000    26 non-null float64
2001    27 non-null float64
2002    28 non-null object
2003    28 non-null int64
2004    28 non-null int64
2005    28 non-null int64
2006    28 non-null int64
2007    28 non-null int64
2008    28 non-null int64
2009    28 non-null int64
2010    28 non-null int64
2011    28 non-null int64
2012    28 non-null int64
2013    28 non-null int64
dtypes: float64(4), int64(11), object(1)
memory usage: 3.7+ KB
</code></pre>

<pre><code class="language-python">df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2002</th>
      <th>2003</th>
      <th>2004</th>
      <th>2005</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Belgium</th>
      <td>1896.0</td>
      <td>1737.0</td>
      <td>1733.0</td>
      <td>1757.0</td>
      <td>1763</td>
      <td>1769</td>
      <td>1751</td>
      <td>1709</td>
      <td>1725</td>
      <td>1738</td>
      <td>1752</td>
      <td>1719</td>
      <td>1765</td>
      <td>1768</td>
      <td>1767</td>
      <td>1765</td>
    </tr>
    <tr>
      <th>Bulgaria</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>2005.0</td>
      <td>2006</td>
      <td>1964</td>
      <td>2007</td>
      <td>1997</td>
      <td>2000</td>
      <td>1989</td>
      <td>1978</td>
      <td>1913</td>
      <td>1976</td>
      <td>1972</td>
      <td>1955</td>
      <td>1954</td>
    </tr>
    <tr>
      <th>Czech Republic</th>
      <td>2124.0</td>
      <td>2157.0</td>
      <td>2128.0</td>
      <td>2029.0</td>
      <td>1984</td>
      <td>1971</td>
      <td>2029</td>
      <td>1959</td>
      <td>1961</td>
      <td>1954</td>
      <td>1967</td>
      <td>1926</td>
      <td>1936</td>
      <td>1912</td>
      <td>1898</td>
      <td>1881</td>
    </tr>
    <tr>
      <th>Denmark</th>
      <td>1646.0</td>
      <td>1783.0</td>
      <td>1666.0</td>
      <td>1709.0</td>
      <td>1776</td>
      <td>1713</td>
      <td>1710</td>
      <td>1719</td>
      <td>1702</td>
      <td>1708</td>
      <td>1711</td>
      <td>1692</td>
      <td>1730</td>
      <td>1750</td>
      <td>1743</td>
      <td>1744</td>
    </tr>
    <tr>
      <th>Germany</th>
      <td>2026.0</td>
      <td>2028.0</td>
      <td>2017.0</td>
      <td>2023.0</td>
      <td>2026</td>
      <td>2003</td>
      <td>2003</td>
      <td>1953</td>
      <td>1974</td>
      <td>1959</td>
      <td>1945</td>
      <td>1879</td>
      <td>1904</td>
      <td>1886</td>
      <td>1863</td>
      <td>1847</td>
    </tr>
  </tbody>
</table>
</div>

<p>Since version .15 Pandas has included memory usage in <code>df.info</code>. We can specify <code>verbose=False</code> if we don&rsquo;t need column descriptions.</p>

<pre><code class="language-python">df.info(verbose=False)
</code></pre>

<pre><code>&lt;class 'pandas.core.frame.DataFrame'&gt;
Index: 28 entries, Belgium to UK
Columns: 16 entries, 1998 to 2013
dtypes: float64(4), int64(11), object(1)
memory usage: 3.7+ KB
</code></pre>

<p>Now let&rsquo;s take a look at some summary statistics with the <code>describe()</code> method.</p>

<pre><code class="language-python">df.describe()
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>1998</th>
      <th>1999</th>
      <th>2000</th>
      <th>2001</th>
      <th>2003</th>
      <th>2004</th>
      <th>2005</th>
      <th>2006</th>
      <th>2007</th>
      <th>2008</th>
      <th>2009</th>
      <th>2010</th>
      <th>2011</th>
      <th>2012</th>
      <th>2013</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>24.000000</td>
      <td>24.000000</td>
      <td>26.000000</td>
      <td>27.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
      <td>28.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1969.583333</td>
      <td>1979.375000</td>
      <td>1962.461538</td>
      <td>1938.370370</td>
      <td>1926.178571</td>
      <td>1934.285714</td>
      <td>1898.857143</td>
      <td>1892.321429</td>
      <td>1891.357143</td>
      <td>1882.035714</td>
      <td>1854.857143</td>
      <td>1874.107143</td>
      <td>1874.892857</td>
      <td>1868.107143</td>
      <td>1862.571429</td>
    </tr>
    <tr>
      <th>std</th>
      <td>131.329627</td>
      <td>124.765802</td>
      <td>136.295042</td>
      <td>133.832889</td>
      <td>139.376669</td>
      <td>136.029370</td>
      <td>136.960312</td>
      <td>131.068841</td>
      <td>127.115641</td>
      <td>122.631783</td>
      <td>117.888433</td>
      <td>109.010478</td>
      <td>107.642185</td>
      <td>106.880459</td>
      <td>105.851198</td>
    </tr>
    <tr>
      <th>min</th>
      <td>1646.000000</td>
      <td>1716.000000</td>
      <td>1666.000000</td>
      <td>1657.000000</td>
      <td>1643.000000</td>
      <td>1685.000000</td>
      <td>1661.000000</td>
      <td>1660.000000</td>
      <td>1659.000000</td>
      <td>1672.000000</td>
      <td>1632.000000</td>
      <td>1670.000000</td>
      <td>1667.000000</td>
      <td>1658.000000</td>
      <td>1648.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1911.000000</td>
      <td>1939.250000</td>
      <td>1922.750000</td>
      <td>1871.500000</td>
      <td>1857.750000</td>
      <td>1860.500000</td>
      <td>1797.500000</td>
      <td>1809.250000</td>
      <td>1801.500000</td>
      <td>1797.000000</td>
      <td>1784.250000</td>
      <td>1797.750000</td>
      <td>1806.000000</td>
      <td>1801.750000</td>
      <td>1809.500000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1978.500000</td>
      <td>1989.500000</td>
      <td>1973.000000</td>
      <td>1965.000000</td>
      <td>1952.500000</td>
      <td>1953.500000</td>
      <td>1898.500000</td>
      <td>1898.500000</td>
      <td>1893.000000</td>
      <td>1897.500000</td>
      <td>1869.500000</td>
      <td>1890.500000</td>
      <td>1879.000000</td>
      <td>1878.000000</td>
      <td>1864.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>2046.000000</td>
      <td>2056.000000</td>
      <td>2032.250000</td>
      <td>2017.500000</td>
      <td>2016.000000</td>
      <td>2041.000000</td>
      <td>2009.000000</td>
      <td>1997.000000</td>
      <td>1989.250000</td>
      <td>1980.500000</td>
      <td>1931.250000</td>
      <td>1952.250000</td>
      <td>1962.750000</td>
      <td>1955.750000</td>
      <td>1937.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>2195.000000</td>
      <td>2199.000000</td>
      <td>2217.000000</td>
      <td>2198.000000</td>
      <td>2189.000000</td>
      <td>2154.000000</td>
      <td>2144.000000</td>
      <td>2114.000000</td>
      <td>2121.000000</td>
      <td>2112.000000</td>
      <td>2091.000000</td>
      <td>2095.000000</td>
      <td>2103.000000</td>
      <td>2103.000000</td>
      <td>2099.000000</td>
    </tr>
  </tbody>
</table>
</div>

<p>At first glance it looks like the average time worked per year is descreasing overtime. Let&rsquo;s examine how the aggregate average mean of the EU has changed over time.</p>

<pre><code class="language-python">df.describe().ix[1].plot(figsize=(10, 4), linewidth=3, alpha =.8)
</code></pre>

<p><img src="output_14_2.png" alt="png" /></p>

<p>Since we&rsquo;re working with time series data we might prefer to transform the data from wide format to long. We&rsquo;ll want the dates to be the index for the given observations so we can simply transpose the dataframe with <code>df.T</code>. Inline with Pandas&rsquo; excellent syntax this instance method is similar to numpy.ndarray.T which is the same as self.transpose().</p>

<pre><code class="language-python">df = df.T
df = df.convert_objects(convert_numeric=True)

df.head(5)
</code></pre>

<div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Belgium</th>
      <th>Bulgaria</th>
      <th>Czech Republic</th>
      <th>Denmark</th>
      <th>Germany</th>
      <th>Estonia</th>
      <th>Ireland</th>
      <th>Greece</th>
      <th>Spain</th>
      <th>France</th>
      <th>...</th>
      <th>The Netherlands</th>
      <th>Austria</th>
      <th>Poland</th>
      <th>Portugal</th>
      <th>Romania</th>
      <th>Slovania</th>
      <th>Slovak Republic</th>
      <th>Finland</th>
      <th>Sweden</th>
      <th>UK</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>1998</th>
      <td>1896.0</td>
      <td>NaN</td>
      <td>2124.0</td>
      <td>1646.0</td>
      <td>2026.0</td>
      <td>2055.0</td>
      <td>1981.0</td>
      <td>2021.0</td>
      <td>1935.0</td>
      <td>1915.0</td>
      <td>...</td>
      <td>1875.0</td>
      <td>1952.0</td>
      <td>2177.0</td>
      <td>1976.0</td>
      <td>2104.0</td>
      <td>1899.0</td>
      <td>2059.0</td>
      <td>1772.0</td>
      <td>1721.0</td>
      <td>1965.0</td>
    </tr>
    <tr>
      <th>1999</th>
      <td>1737.0</td>
      <td>NaN</td>
      <td>2157.0</td>
      <td>1783.0</td>
      <td>2028.0</td>
      <td>2026.0</td>
      <td>1979.0</td>
      <td>2056.0</td>
      <td>2001.0</td>
      <td>1950.0</td>
      <td>...</td>
      <td>1863.0</td>
      <td>1986.0</td>
      <td>2152.0</td>
      <td>2012.0</td>
      <td>2099.0</td>
      <td>1954.0</td>
      <td>2056.0</td>
      <td>1716.0</td>
      <td>1842.0</td>
      <td>1960.0</td>
    </tr>
    <tr>
      <th>2000</th>
      <td>1733.0</td>
      <td>NaN</td>
      <td>2128.0</td>
      <td>1666.0</td>
      <td>2017.0</td>
      <td>1974.0</td>
      <td>1972.0</td>
      <td>2065.0</td>
      <td>1940.0</td>
      <td>1864.0</td>
      <td>...</td>
      <td>1846.0</td>
      <td>1980.0</td>
      <td>2033.0</td>
      <td>1954.0</td>
      <td>2143.0</td>
      <td>1918.0</td>
      <td>2053.0</td>
      <td>1675.0</td>
      <td>1839.0</td>
      <td>1940.0</td>
    </tr>
    <tr>
      <th>2001</th>
      <td>1757.0</td>
      <td>2005.0</td>
      <td>2029.0</td>
      <td>1709.0</td>
      <td>2023.0</td>
      <td>2005.0</td>
      <td>1965.0</td>
      <td>2043.0</td>
      <td>1934.0</td>
      <td>1870.0</td>
      <td>...</td>
      <td>1861.0</td>
      <td>1991.0</td>
      <td>2012.0</td>
      <td>1960.0</td>
      <td>2148.0</td>
      <td>1873.0</td>
      <td>2052.0</td>
      <td>1657.0</td>
      <td>1674.0</td>
      <td>1944.0</td>
    </tr>
    <tr>
      <th>2002</th>
      <td>1763.0</td>
      <td>2006.0</td>
      <td>1984.0</td>
      <td>1776.0</td>
      <td>2026.0</td>
      <td>2058.0</td>
      <td>1938.0</td>
      <td>2059.0</td>
      <td>1952.0</td>
      <td>1842.0</td>
      <td>...</td>
      <td>1756.0</td>
      <td>1982.0</td>
      <td>2040.0</td>
      <td>1936.0</td>
      <td>2167.0</td>
      <td>1906.0</td>
      <td>2036.0</td>
      <td>1686.0</td>
      <td>1693.0</td>
      <td>1939.0</td>
    </tr>
  </tbody>
</table>
<p>5 rows × 28 columns</p>
</div>

<h2 id="examining-relationships-with-plotting">Examining Relationships with Plotting</h2>

<p>Let&rsquo;s take a look at Germany, UK, and France vs the <a href="http://en.wikipedia.org/wiki/PIGS_%28economics%29">PIIGS</a>. Seaborn makes it easy to set palettes from <a href="http://colorbrewer2.org/">colorbrewer</a>. Note that I append a standard matplotlib method to Panda&rsquo;s <code>plot()</code> helper function to set the legend size below.</p>

<pre><code class="language-python">sns.set_palette(&quot;Set2&quot;, 10, 1)
sns.palplot(sns.color_palette(&quot;Set2&quot;, 10,1))
</code></pre>

<p><img src="output_19_0.png" alt="png" /></p>

<pre><code class="language-python">guf_vs_piigs = ['Germany', 'UK', 'France','Portugal', 'Italy', 'Ireland', 'Greece', 'Spain']
df.ix[:, guf_vs_piigs].plot(figsize=(13, 7),
                            linewidth=3,
                            alpha =.8,
                            title = &quot;Germany, UK, and France vs the PIIGS Annual Average Hours Worked per Employee&quot;).legend(loc=3,prop={'size':15})
</code></pre>

<p><img src="output_20_2.png" alt="png" /></p>

<p>Note that the decline in hours worked deaccelerates around 2005 for all countries except Germany.
Now what if we want to examine all time series plots at once to quickly examine countries with the most drastic change? Note the assignment to supress in order to supress the matplotlib inline rendering messages (e.g. <code>&lt;matplotlib.axes._subplots.AxesSubplot at 0x10bb579d0&gt;</code>)</p>

<pre><code class="language-python">supress = df.plot(subplots=True, layout=(8, 4), figsize=(16, 16,), sharex=False, alpha =.7)
</code></pre>

<p><img src="output_22_0.png" alt="png" /></p>

<p>It might be interesting to look at a correlation matrix to reveal relationships between the countries.</p>

<pre><code class="language-python">plt.rcParams['figure.figsize'] = 15, 15

supress = sns.corrplot(df, annot=False, sig_stars=False,
             diag_names=False, cmap=&quot;coolwarm&quot;)
</code></pre>

<p><img src="output_24_0.png" alt="png" /></p>

<p>The correlation matrix indicates that Denmark is going against the trend as it rarely correlates with other countries (lots of blue), just as the line plot indicated above. Another interesting summary statistic might be the sum of total percentage change per country which indicates what country had the most drastic change to date. Luckily Pandas has an instance method for that.</p>

<pre><code class="language-python">pct_change_sum = df.pct_change().sum()
pct_change_sum.sort() # inplace method default
print 'Absolute Mean Percentage Change: ' + str(pct_change_sum.abs().mean())
print ''
print pct_change_sum
</code></pre>

<pre><code>Absolute Mean Percentage Change: 0.0603916775238

France            -0.137442
Latvia            -0.124114
Czech Republic    -0.118457
Poland            -0.111631
Germany           -0.091152
Luxembourg        -0.087165
Ireland           -0.080509
Italy             -0.074149
Portugal          -0.072338
Malta             -0.071814
Austria           -0.070783
Finland           -0.070174
Belgium           -0.066778
Spain             -0.065156
Slovak Republic   -0.061676
Lithuania         -0.060430
Estonia           -0.057099
Hungary           -0.035527
UK                -0.033165
The Netherlands   -0.029818
Slovania          -0.029289
Croatia           -0.025596
Bulgaria          -0.024140
Sweden            -0.012458
Cyprus            -0.007883
Greece            -0.004757
Romania           -0.001922
Denmark            0.065546
dtype: float64
</code></pre>

<p>Compared to the mean absolute percentage change of 0.06, France is clearly leading the EU in reducing hours worked from 1998 - 2013. Conversely Denmark stands alone in increasing hours worked.</p>

<h2 id="statistical-methods">Statistical Methods</h2>

<p>Let&rsquo;s explore the relationship between time and unemployment using France&rsquo;s data and linear regression. If you&rsquo;re unfamiliar with concepts behind linear regression check out this <a href="http://ipython-books.github.io/featured-04/">link</a>. This is meant to be a short intro so we won&rsquo;t explore how to tune a fit and make better approximations of the underlying distribution of the data.</p>

<pre><code class="language-python">df[&quot;France&quot;]
</code></pre>

<pre><code>1998    1915.0
1999    1950.0
2000    1864.0
2001    1870.0
2002    1842.0
2003    1712.0
2004    1708.0
2005    1661.0
2006    1660.0
2007    1659.0
2008    1672.0
2009    1640.0
2010    1679.0
2011    1682.0
2012    1681.0
2013    1661.0
Name: France, dtype: float64
</code></pre>

<pre><code class="language-python">known_x = np.arange(len(df.France)) # Create the index
known_y = df.France # Return a pandas series from a df object

# Find the polynomial coefficients
linear_coef = np.polyfit(known_x, known_y, 1)

# Pass polynomial coefficients to poly1d convenience function (highest power 1st)
linear_poly = np.poly1d(linear_coef)
</code></pre>

<p>NumPy&rsquo;s poly1d function allows you to pass a future unkown time index, or whatever type of x value you fit on, to return a y value.</p>

<p>For example we fit on <code>known_x = np.arange(len(df.France))</code> which contained 16 elements (1998-2013). Below we use our <code>linear_poly</code> to see what the annual average hours worked per employee might look like in 2020:</p>

<pre><code class="language-python">linear_poly(23)
</code></pre>

<p><code>1449.4632352941185</code></p>

<p>We can also construct a quadratic fit with the same methods except we pass <code>2</code> to denote the degree.</p>

<pre><code class="language-python">a,b = linear_poly.coeffs # slope, intercept

quadratic_coef = np.polyfit(known_x, known_y, 2)
quadratic_poly = np.poly1d(quadratic_coef)
</code></pre>

<p>Below we plot our simple linear regression and quadratic models:</p>

<pre><code class="language-python">known_x_labels = np.array(list(df.index)) # For x-axis labeling 
plt.rcParams['figure.figsize'] = 9, 5
plt.scatter(known_x_labels, known_y, label = 'Original Data')
plt.plot(known_x_labels,known_y, alpha = .3, label = 'Original Data')
plt.plot(known_x_labels, linear_poly(known_x), 'r', alpha=.8, label='Linear Regression') # y = a + bx or y = mx + b 
plt.plot(known_x_labels, quadratic_poly(known_x), '-', label='Quadratic Fit') # y = ax^2 + bx + c
plt.title('France Average Annual Hours Worked per Employee')
plt.legend()

print 'Linear Regression'
print 'slope: %s' % a, 'intercept: %s' % b
</code></pre>

<p><code>Linear Regression</code><br />
<code>slope: -18.8088235294 intercept: 1882.06617647</code></p>

<p><img src="output_35_1.png" alt="png" /></p>

<h2 id="imputation-filling-missing-data">Imputation (filling missing data)</h2>

<p>When we have abundant data we might not think twice about discarding incomplete or missing observations for any given index. Depending on the work at hand and the size of the dataset, the practice of discarding NaNs may introduce some unforeseen bias. We might decouple some trend or miss an element of cyclically or seasonality. In essence imputation allows us to preserve all cases by replacing missing data with a probable value based on other available information. The practice of imputation goes much deeper when you start using simulations and probabilistic models.</p>

<p>We&rsquo;ve been working with a complete and vetted dataset so far. What should we do when the time-series data we&rsquo;re working with is incomplete? Let&rsquo;s say the governing body of this study was unable to collect data for some set of years. Here is the current complete set:</p>

<pre><code class="language-python">df.France
</code></pre>

<pre><code>1998    1915
1999    1950
2000    1864
2001    1870
2002    1842
2003    1712
2004    1708
2005    1661
2006    1660
2007    1659
2008    1672
2009    1640
2010    1679
2011    1682
2012    1681
2013    1661
Name: France, dtype: float64
</code></pre>

<p>And here is the data with 2004, 2010, 2011 employment data missing (NaN):</p>

<pre><code class="language-python">France_incomplete  = df.France.copy()

France_incomplete[['2004','2010','2011']] = np.NaN
France_incomplete
</code></pre>

<pre><code>1998    1915
1999    1950
2000    1864
2001    1870
2002    1842
2003    1712
2004     NaN
2005    1661
2006    1660
2007    1659
2008    1672
2009    1640
2010     NaN
2011     NaN
2012    1681
2013    1661
Name: France, dtype: float64
</code></pre>

<p>With imputation, we have a large array of methods to employ depending on the requirements of what analysis we intend to do with the data. Are we cleaning up the data for ploting purposes to demonstrate a simple point or are we planning to use the data to describe the directionality of an equity?</p>

<p>Since this is one-dimensional data we could naively fill these values with the mean of the entire column. This might work okay for a larger set of time-series data with no clear trend and intermittent dispersed NaNs.</p>

<p>For exampe:</p>

<pre><code class="language-python">France_incomplete.fillna(value = France_incomplete.mean())
</code></pre>

<pre><code>1998    1915.000000
1999    1950.000000
2000    1864.000000
2001    1870.000000
2002    1842.000000
2003    1712.000000
2004    1752.846154
2005    1661.000000
2006    1660.000000
2007    1659.000000
2008    1672.000000
2009    1640.000000
2010    1752.846154
2011    1752.846154
2012    1681.000000
2013    1661.000000
Name: France, dtype: float64
</code></pre>

<p>This might make for a bad method given that two of the two values are next to each other so we might flat line the momentum that the series had. What if we carry forward the last known value using the forward-fill method in Pandas?</p>

<pre><code class="language-python">plt.rcParams['figure.figsize'] = 7, 3.5

# Original data
df.France.plot(color = 'black')
# Using the mean
France_incomplete.fillna(value = France_incomplete.mean()).plot(color = 'orange',alpha = .5)
# Filling forward
France_incomplete.fillna(method= 'ffill').plot(color = 'dodgerblue',alpha = .5)
</code></pre>

<p><img src="output_43_1.png" alt="png" /></p>

<p>In the simple case we see that forward-filling more closely resembles the original complete data. <code>nafill</code> also provides {‘backfill’, ‘bfill’, ‘pad’, ‘ffill’}. Check out the official documentation: <a href="http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html">http://pandas.pydata.org/pandas-docs/stable/generated/pandas.DataFrame.fillna.html</a></p>

<h2 id="trend-extrapolation">Trend Extrapolation</h2>

<p>Trend Extrapolation is a forecasting technique which uses methods such as exponential smoothing or moving averages to project the future pattern of a time series data. Forecasting is very hard and at times you have to walk a fine line between overfitting some set of data with a higher order polynomial and producing non-practical (or non-sensical) results with ARIMA.</p>

<p>Let&rsquo;s go over some practical and easy to implement forecasting methods below using the entire EU dataset and extrapolate it out to 2020 with basic linear regression.</p>

<pre><code class="language-python">colnames = [colname for colname in df.columns]

# 1998 - 2013
years_into_future = 7
known_x = np.arange(df.shape[0]) # Current time interval
new_x = np.arange(len(known_x), len(known_x) + years_into_future, 1) # 7 years into future
concat_x = np.concatenate((known_x, new_x),axis=0)

out = np.empty(shape=(concat_x.shape[0], len(colnames)), dtype=float) # Empty faster than zero

# Return tuple of index and value
for col_index in enumerate(colnames):
    known_y = df.iloc[:,col_index[0]]
    known_y = known_y.fillna(value=known_y.mean())
    
    linear_coef = np.polyfit(known_x, known_y, 1)
    linear_poly = np.poly1d(linear_coef)

    new_y = linear_poly(new_x)   
    #new_y = new_y[::-1] # Reverse projections
    
    concat_y = np.concatenate((known_y,new_y),axis=0)
    out[:, col_index[0]] = concat_y

extended_df = pd.DataFrame(out)
extended_df.columns = colnames


extended_df.index = pd.date_range(start = '1998',
                                  end = '2021',
                                  freq='A')
</code></pre>

<pre><code class="language-python">supress = extended_df.plot(subplots=True, layout=(7, 4), figsize=(16, 16), alpha =.6, sharex=False);
</code></pre>

<p><img src="output_47_0.png" alt="png" /></p>

<p>Above we see the simple straight line projection to 2020. Again we can change the polynomial degree number in the polyfit function above or replace the new value generator with something more robust.</p>

<p>What if we have some domain knowledge that won&rsquo;t be reflected in the current data or trend? For example, what if I have insider knowledge of a bizarre policy that will be enacted by the EU to increase annual hours worked by employees X% by 2020? What might that look like?</p>

<p>I can anchor a point out in the future (2020) based on some simple descriptive statistic like the max value of the current data set plus 1 standard deviation then interpolate all the missing values between 2013 and 2020. An economist would use a more sophisticated growth model of course. I can use one of SciPy&rsquo;s many interpolation methods, which are conveniently called from Pandas, to fill the empty range in a smooth and more &ldquo;natural&rdquo; method opposed to a straight linear regression line.</p>

<pre><code class="language-python">colnames = [colname for colname in df.columns]

# 1998 - 2013
years_into_future = 7
known_x = np.arange(df.shape[0]) # Current time interval
new_x = np.arange(len(known_x), len(known_x) + years_into_future, 1) # 7 years into future
concat_x = np.concatenate((known_x, new_x),axis=0)

out = np.empty(shape=(concat_x.shape[0], len(colnames)), dtype=float) # Empty faster than zero

# Return tuple of index and value
for col_index in enumerate(colnames):
    known_y = df.iloc[:,col_index[0]]
    known_y = known_y.fillna(value=known_y.mean())
    
    new_y = np.zeros(shape=(len(new_x),))
    new_y[-1] = np.max(known_y) + (np.std(known_y) * 1)
    concat_y = np.concatenate((known_y,new_y),axis=0)
    
    out[:, col_index[0]] = concat_y

extended_df = pd.DataFrame(out)
extended_df.columns = colnames

extended_df.index = pd.date_range(start = '1998',
                                  end = '2021',
                                  freq='A')
</code></pre>

<pre><code class="language-python"># All the options described here: http://pandas.pydata.org/pandas-docs/stable/generated/pandas.Series.interpolate.html
# {‘linear’, ‘time’, ‘index’, ‘values’, ‘nearest’, ‘zero’,
# ‘slinear’, ‘quadratic’, ‘cubic’, ‘barycentric’, ‘krogh’, ‘polynomial’, ‘spline’ ‘piecewise_polynomial’, ‘pchip’}

extended_df.replace(0, np.nan, inplace=True)

# Must specify order for poly
extended_df.interpolate(method='pchip', axis=0, limit=None, inplace=True, downcast=None)

supress = extended_df.plot(subplots=True, layout=(7, 4), figsize=(16, 16), alpha =.6, sharex=False);
</code></pre>

<p><img src="output_50_0.png" alt="png" /></p>

<p>Here&rsquo;s another fun view:</p>

<pre><code class="language-python">extended_df.plot(figsize=(16, 9), alpha =.6)
</code></pre>

<p><img src="output_52_1.png" alt="png" /></p>

  </main>

          <footer role="contentinfo">
  <div>
    <label for="themer">
      dark theme: <input type="checkbox" id="themer" class="vh">
      <span aria-hidden="true"></span>
    </label>
  </div>
  
    Made w/ <a href="https://gohugo.io/">Hugo</a>. Deployed by <a href="https://app.netlify.com/">Netlify</a>.
  
</footer>

        </div>
      </div>
    </div>
    <script src="https://kldavenport.com/js/prism.js"></script>
<script src="https://kldavenport.com/js/dom-scripts.js"></script>

    
  
  <script>
  window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)};ga.l=+new Date;
  ga('create', 'UA-34706513-1', 'auto');
  ga('send', 'pageview');
  </script>
  <script async src='https://www.google-analytics.com/analytics.js'></script>
  

  </body>
</html>
